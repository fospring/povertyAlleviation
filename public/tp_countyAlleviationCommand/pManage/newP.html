<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>县脱贫攻坚指挥部</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <link rel="stylesheet" href="../../../bower_components/bootstrap/dist/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../../../bower_components/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="../../../bower_components/Ionicons/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../../dist/css/AdminLTE.css">
  <!-- AdminLTE Skins. We have chosen the skin-blue for this starter项目库
        page. However, you can choose any other skin. Make sure you
        apply the skin class to the body tag so the changes take effect. -->
  <link rel="stylesheet" href="../../../dist/css/skins/skin-blue.min.css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Google Font -->
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
  <script src="../../../dist/js/myjs.js"></script>
</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to get the
desired effect
|---------------------------------------------------------|
| SKINS         | skin-blue                               |
|               | skin-black                              |
|               | skin-purple                             |
|               | skin-yellow                             |
|               | skin-red                                |
|               | skin-green                              |
|---------------------------------------------------------|
|LAYOUT OPTIONS | fixed                                   |
|               | layout-boxed                            |
|               | layout-top-nav                          |
|               | sidebar-collapse                        |
|               | sidebar-mini                            |
|---------------------------------------------------------|
-->
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <!-- Main Header -->
  <header class="main-header">

  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        首页
        <small>->项目库管理</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>
        <li class="active">Here</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content container-fluid">

      <!--------------------------
        | Your Page Content Here |
        -------------------------->
      <div class="box">
        <div class="box-header with-border">
          <h3 class="box-title">项目库</h3>
          <!-- /.box-tools -->
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <div>

            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
              <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">新建项目</a></li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
              <div role="tabpanel" class="tab-pane active" id="home">
          <br>          <form class="form-horizontal">
            <div class="form-group form-group-sm">
              <label for="inputEmail3" class="col-sm-2 control-label">项目库名称：</label>
              <div class="col-sm-4">
                <select class="form-control" name="natureOfP" id="projectlibraryId"></select>
              </div>
            </div>
            <div class="form-group form-group-xs">
              <label for="inputPassword3" class="col-xs-2 control-label">项目编号：</label>
              <div class="col-xs-4">
                <input type="input" class="form-control" id="projectId" value="">
              </div>
              <label for="natureOfP" class="col-xs-2 control-label">项目性质：</label>
              <div class="col-xs-4">
                <select class="form-control" id="projectNature">
                  <option selected="selected" value="公路交通">公路交通</option>
                  <option value="水利">水利</option>
                  <option value="产业">产业</option>
                  <option value="其他">其他</option>
                </select>
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="pName" class="col-sm-2 control-label">项目名称：</label>
              <div class="col-sm-10">
                <input type="input" class="form-control" id="projectName" value="石门乡乡道改造">
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="natureOfP" class="col-sm-2 control-label">市州/区县/乡镇：</label>
              <div class="col-sm-2">
                <input type="input" class="form-control" id="city" readonly>
              </div>
              <div class="col-sm-2">
                <input type="input" class="form-control" id="county" readonly>
              </div>
              <div class="col-sm-2">
                <input type="input" class="form-control" id="township" readonly>
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="pAddress" class="col-sm-2 control-label">项目地址：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="pAddress" value="石门乡">
              </div>
              <label for="CInvestment" class="col-sm-2 control-label">建设投资额（亿元）：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="totalMoney" value="0">
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="uUnits" class="col-sm-2 control-label">承接单位：</label>
              <div class="col-sm-4">
                <select class="form-control" id="constructionUnit">
                  <option selected="selected" value="中国第四建筑有限公司">中国第四建筑有限公司</option>
                  <option value="中国铁路建设有限公司">中国铁路建设有限公司</option>
                </select>
              </div>
              <label for="2016_invest" class="col-sm-2 control-label">2017年（万元）：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="2017Money" value="0">
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="cLUUnit" class="col-sm-2 control-label">县级承担部门：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="countyUnit" value="威宁县公路局">
              </div>
              <label for="2017_invest" class="col-sm-2 control-label">2018年（万元）：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="2018Money" value="0">
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="tRDate" class="col-sm-2 control-label">任务下达日期：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="tRDate" value="2016年7月1日">
              </div>
              <label for="2018_invest" class="col-sm-2 control-label">2019年（万元）：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="2019Money" value="0">
              </div>
            </div>
            <div class="form-group form-group-sm">
              <label for="wDOFunds" class="col-sm-2 control-label">资金退出日期：</label>
              <div class="col-sm-4">
                <input type="input" class="form-control" id="wDOFunds" value="--">
              </div>
              <label for="rCTime" class="col-sm-2 control-label">要求完成时间：</label>
              <div class="col-sm-4">
                <input type="date" class="form-control" id="completeTime">
              </div>
            </div> 
            <div class="box-header with-border">
              <h3 class="box-title">
                项目信息
              </h3>
              <!-- /.box-tools -->
            </div>
            <br>
            <div class="form-group form-group-sm">
              <label for="bBackground" class="col-sm-2 control-label">商务背景：</label>
              <div class="col-sm-10">
                <textarea class="form-control" id="bBackground" value="无" rows="6">无</textarea>
              </div>
            </div> 
            <div class="form-group form-group-sm">
              <label for="tInformation" class="col-sm-2 control-label">技术资料：</label>
              <div class="col-sm-10">
                <textarea class="form-control" id="tInformation" value="无" rows="6">无</textarea>
              </div>
            </div> 
            <div class="form-group form-group-sm">
              <label for="wDOFunds" class="col-sm-2 control-label">上传资料：</label>
              <div class="col-sm-3">
                  <input type="file" id="exampleInputFile">
              </div>              
              <div class="col-sm-6">
                <input type="input" class="form-control" id="fDescription" placeholder="请填写文件说明">
              </div>
              <div class="col-sm-1">
                <a class="btn btn-primary btn-xs">上传</a>
              </div>
            </div>  
            <div class="form-group form-group-sm">
              <label for="sFDescription" class="col-sm-offset-1 col-sm-3 control-label"><a>石门乡乡道改造项目补充说明.pdf</a></label>
              <div class="col-sm-6">
                <span>石门乡乡道改造项目补充说明</span>
              </div>
              <div class="col-sm-2">
               <a title="删除已上传文件"><i class="glyphicon glyphicon-remove" style="color: #d9534f;"></i></a>
              </div>
              <br>
            </div> 
            <div class="form-group form-group-sm">
              <label for="sFDescription" class="col-sm-offset-1 col-sm-3 control-label"><a>石门乡乡道改造项目预算说明.pdf</a></label>
              <div class="col-sm-6">
                <span>石石门乡乡道改造项目预算说明</span>
              </div>
              <div class="col-sm-2">
               <a title="删除已上传文件"><i class="glyphicon glyphicon-remove" style="color: #d9534f;"></i></a>
              </div>              
            </div> 
            <div class="form-group form-group-sm">
              <label for="bBackground" class="col-sm-2 control-label">有关问题及措施：</label>
              <div class="col-sm-10">
                <textarea class="form-control" id="bBackground" rows="3">省委督查室下达文件，要求公路局上报方案，基金公司春节前下达资金款</textarea>
              </div>
            </div> 
            <div class="form-group form-group-sm">
              <label for="tInformation" class="col-sm-2 control-label">落实情况：</label>
              <div class="col-sm-10">
                <textarea class="form-control" id="tInformation" rows="3">省公路局12月20日前上报方案，脱贫公司春节前募资到位</textarea>
              </div>
            </div> 
          </form>
      <div class="modal-footer">
        <a type="button" class="btn btn-info" onclick="addProject();" data-dismiss="modal">新建项目</a>
      </div>
              </div>
            </div>

          </div>   
          <br>
        </div>
        <!-- /.box-body -->
      </div>
      <!-- /.box -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Main Footer -->
  <script type="text/javascript">
    mainFooter();
  </script>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Create the tabs -->
    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
      <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
      <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
      <!-- Settings tab content -->
      <div class="tab-pane" id="control-sidebar-settings-tab">
        <form method="post">
          <h3 class="control-sidebar-heading">General Settings</h3>

          <div class="form-group">
            <label class="control-sidebar-subheading">
              Report panel usage
              <input type="checkbox" class="pull-right" checked>
            </label>

            <p>
              Some information about this general settings option
            </p>
          </div>
          <!-- /.form-group -->
        </form>
      </div>
      <!-- /.tab-pane -->
    </div>
  </aside>
  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
  immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 3 -->
<script src="../../../bower_components/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="../../../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- AdminLTE App -->
<script src="../../../dist/js/adminlte.js"></script>

<!-- Optionally, you can add Slimscroll and FastClick plugins.
     Both of these plugins are recommended to enhance the
     user experience. -->
  <script>
  /*
   *加载header、sider和footer
  */
    $(".main-header").load("../mainheader.html"); 
    $(".main-sidebar").load("../mainsider.html");
/*
*
*/
$(document).ready(function(){

        var postBody = {
            county:"B县"
        };
        $.ajax({
            type: 'POST',
            url: 'http://localhost:3000/fmtest/county/search/projectlibrary',
            data: postBody,
            dataType: 'json',
            success: function(data){      
              var jsonstr=JSON.stringify(data);
              console.log(jsonstr);
                for(var o in data){
                  if(o == 0){
                    $('<option selected value="'+data[o]._id+'">'+data[o].libraryName+'</option>').appendTo("#projectlibraryId");
                    $("#city").val(data[o].city);
                    $("#county").val(data[o].county);
                    $("#township").val(data[o].township);
                    }else{
                    $('<option value="'+data[o]._id+'">'+data[o].libraryName+'</option>').appendTo("#projectlibraryId");
                    $('<option value="'+data[o].city+'">'+data[o].city+'</option>').appendTo("#city");
                    $('<option value="'+data[o].county+'">'+data[o].county+'</option>').appendTo("#county");
                    $('<option value="'+data[o].township+'">'+data[o].township+'</option>').appendTo("#township");
                  }
                }

            }
         }).error(function(err){
            console.log(err);
            alert("服务器忙！请稍后再尝试");
          });

    $("#result").hide();
    $("#search").click(function(){
      $("#result").show();
    });
});

function addProject(){
      var postBody = {
          plId:$("#projectlibraryId").val(),
          projectId:$("#projectId").val(),
          projectNature:$("#projectNature").val(),
          projectName:$("#projectName").val(),
          constructionUnit:$("#constructionUnit").val(),
          countyUnit:$("#countyUnit").val(),
          totalMoney:$("#totalMoney").val(),
          money2017:$("#2017Money").val(),
          money2018:$("#2018Money").val(),
          money2019:$("#2019Money").val(),
          opId:getCookie("opcuserId"),
          completeTime:$("#completeTime").val()
      };
      $.ajax({
          type: 'POST',
          url: 'http://localhost:3000/fmtest/create/project',
          data: postBody,
          dataType: 'json',
          success: function(data){      
            var jsonstr=JSON.stringify(data);
            console.log(jsonstr);
            alert("项目添加成功!");
            window.location.href="pM.html"
          }
       }).error(function(err){
          console.log(err);
          alert("服务器忙！请稍后再尝试");
        });
 }
  </script>
</body>
</html>